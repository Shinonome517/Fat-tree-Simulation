{
  "name": "MP-QUIC Mininet/OVS DevContainer",
  // 既存の Dockerfile をビルドに利用（プロジェクト直下想定）
  "build": {
    "dockerfile": "../Dockerfile",
    "context": ".."
  },

  // エントリポイントは Dockerfile のものをそのまま使う
  "overrideCommand": true,
  "command": "bash -lc 'sleep infinity'",


  // Mininet/OVS を正しく動かすための実行時オプション
  "runArgs": [
    "--privileged",
    "--network=host",
    "-v", "/lib/modules:/lib/modules:ro",
    "--ulimit", "memlock=-1"
  ],

  // root で作業（Mininet/OVS は root 前提）
  "remoteUser": "root",

  // コンテナ初回作成後に一度だけ実行（バージョン確認など）
  "postCreateCommand": "bash .devcontainer/scripts/post_create.sh",

  // コンテナ起動のたびに実行（健全性チェック）
  "postStartCommand": "bash .devcontainer/scripts/mininet_sanity.sh || true",

  // 推奨拡張（任意）
  "customizations": {
    "vscode": {
      "extensions": [
        "ms-vscode.cpptools",
        "ms-vscode.cmake-tools",
        "ms-azuretools.vscode-docker",
        "ms-python.python"
      ]
    }
  },

  // ワークスペースは既定の bind mount（${localWorkspaceFolder} → /workspaces/<name>）
  // 追加のマウントが必要なら "mounts" に追記
  "shutdownAction": "stopContainer"
}
